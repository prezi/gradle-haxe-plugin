group = 'com.prezi.gradle'

buildscript {
	repositories {
		mavenLocal()
		maven {
			credentials {
				username nexusUser
				password nexusPassword
			}
			url "https://artifactory.prezi.com/plugins-snapshot"
		}
	}

	dependencies {
		classpath "com.prezi.gradle:gradle-prezi-plugin:1.0-SNAPSHOT"
	}
}

apply plugin: 'groovy'
apply plugin: 'maven'
apply plugin: 'idea'
apply plugin: 'prezi'

dependencies {
    compile gradleApi()
    compile localGroovy()
}

task run(type: Exec) {
	workingDir "test/at"
	commandLine = [ "gradle", "clean", "test", "install", "-Pmunit.kill-browser", "--info", "--stacktrace" ]
}

uploadArchives {
    repositories {
        mavenDeployer {
            repository(url: "https://artifactory.prezi.com/plugins-snapshot-local/") {
                authentication(userName: nexusUser, password: nexusPassword)
            }
        }
    }
}
